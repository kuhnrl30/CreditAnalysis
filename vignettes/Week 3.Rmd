---
title: "Week 3: T-tests"
---

##Problem 1
The scenario is that the auditor is testing error rates in a transaction set.  They have developed reliable monthly estimates of the error rate in transactions and management asserts that the error rates are less than 1%. With transaction error rates, the audit risk is that the error rates are greater than management's estimate.  

```{r, results='hold'}
library(CreditAnalysis)
data("errorestimates")

# Calculate descriptive statistics
Monthly<- errorestimates[,1]
mean(Monthly)   # mean
sd(Monthly)     # Standard Deviation
var(Monthly)    # Variance
median(Monthly) # Median
```

Before performing any statistical tests, we need to state the null and 
alternate hypothesis.  In the given scenario, the null hypothesis is that error rate 
in the sampled months are less than or equal to management's assertion about the error 
rate (1%). The alternative hypothesis is that the sample does not match management's 
assertion and that the population mean is significantly different. Specifically:

H0: The sample mean is less than or equal to management's estimate of the error
rates with statistical significance at the 95% confidence level.  
H1: The sample mean is greater than management's estimate of the monthly errors with
95% confidence.

To perform the test, we use a t.test. We'll use a 1-tailed test because there is no 
audit risk if the actual error rate is less than management's assertion.

```{r}
t.test(Monthly, 
       alternative="greater",   # 1 tailed test
       mu=0.01,                  # Management assertion
       conf.level=0.95)
```

The t-value for 95% confidence with 11 degrees of freedom is 2.20 ( [Source](http://www.ruf.rice.edu/~bioslabs/tools/stats/ttable.html) ).  Since the t value from this test (0.838) is less than the minimum and the p-value is greater than 0.05, we cannot reject the null hypothesis. 

##Problem 2
The objective of this problem is to become familiar with the t.test() function. 

```{r}
# Load the data and convert the dataframes to vectors
data("creditsales")
Credit<- creditsales[,1]

data(cashsales)
Cash<- cashsales[,1]

# calculate descriptive statistics
data.frame(length=c(length(Credit),length(Cash)),
           mean= c(mean(Credit), mean(Cash)),
           sd= c(sd(Credit),sd(Cash)),
           var= c(var(Credit),var(Cash)),
           med= c(median(Credit),median(Cash)),
           row.names = c("Credit","cash"))
```

The next objective is to estimate the mean of the Credit Sales population based 
on the sample from the population.

```{r}
t.test(Credit,conf.level=0.95)
```

Based on the results of this test, we can say with 95% confidence that the Cash
population mean is between 22613.73 and 23442.28.  

```{r}
t.test(Cash,conf.level=0.99)
```

Based on the results of this test, we can say with 99% confidence that the Cash
population mean is between 21,194.65 and 22,623.53.  

```{r}
t.test(Credit,Cash,
       alternative="greater", # 1 tailed test
       conf.level=0.95)
```

The t-value for 95% confidence with 29 degrees of freedom is 2.04.  Since the t 
score is greater than the t-value and the p value is less than .05, we can reject 
the null hypothesis that the population means are equal.  The test gives evidence to
support at 95% confidence that Cash population mean is less than the Credit population
mean. 
